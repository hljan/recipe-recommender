{% extends "base.html" %}
{% block title %} Text Search {% endblock %}

{% block navbarContent %}
<ul class="menu-area-main">
    <li>User ID: {{ user_id }}</li>
    <li class="active">
        <a href="{{ url_for('main.initial_search', user_id=user_id, db_connected=db_connected) }}">Home</a>
    </li>
    <li>
        <a href="{{ url_for('auth.logout') }}">
            <img class="logout_btn" src="/static/icon/logout.png" alt="logout"/>
        </a>
    </li>
</ul>
{% endblock %}
{% block bodyContent %}
    <div class="column is-6 is-offset-2 box">

                <h1>Your Recommended Recipes!</h1>
                <hr>
                <h6>Main ingredients: {% for ingredient in main_ingredients %} {{ ingredient }} {% endfor %}</h6>
                <h6>Side ingredients: {% for ingredient in side_ingredients %} {{ ingredient }} {% endfor %}</h6>
                <hr>

                <div class="tab">
                    <button class="tablinks" onclick="openTab(event,'matching_recipe')">Matching Recipes</button>
                    <button class="tablinks" onclick="openTab(event,'content_based')">Filtered By My Review History</button>
                    <button class="tablinks" onclick="openTab(event,'collab_filter')">Similar User's Reviews</button>
                </div>

                <div class="tabcontent" id="matching_recipe">
                    <span onclick="this.parentElement.style.display='none'" class="topright">&times;</span>
                    <table>
                    <tr>
                        <th>Name</th>
                    </tr>
                    {%  for recipe in matching_recipes %}
                        {% set recipe2=recipe.recipeID|string + "&" + recipe.recipeName%}
                    <tr>
                        <td><a href="{{ url_for('main.recipe_details', recipe=recipe2, recipe_id=recipe.recipeID, user_id=user_id) }}">{{recipe.recipeName}}</a></td>
                    </tr>
                    {% endfor %}
                </table>
                </div>
                <div class="tabcontent" id="content_based">
                    <span onclick="this.parentElement.style.display='none'" class="topright">&times;</span>
                    <table>
                    <tr>
                        <th>Name</th>
                    </tr>
                    {%  for recipe in content_based %}
                    {% set recipe2=recipe.recipeID|string + "&" + recipe.recipeName%}
                    <tr>
                        <td><a href="{{ url_for('main.recipe_details', recipe=recipe2, recipe_id=recipe.recipeID, user_id=user_id) }}">{{recipe.recipeName}}</a></td>
                    </tr>
                    {% endfor %}
                </table>
                </div>

                <div class="tabcontent" id="collab_filter">
                    <span onclick="this.parentElement.style.display='none'" class="topright">&times;</span>
                    <table>
                    <tr>
                        <th>Name</th>
                    </tr>
                    {%  for recipe in collab_filter %}
                    {% set recipe2=recipe.recipeID|string + "&" + recipe.recipeName%}
                    <tr>
                        <td><a href="{{ url_for('main.recipe_details', recipe=recipe2, recipe_id=recipe.recipeID, user_id=user_id) }}">{{recipe.recipeName}}</a></td>
                    </tr>
                    {% endfor %}
                </table>
                </div>
            </div>
    <script>
    function openTab(evt, tabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }

    var coll = document.getElementsByClassName("collapsible");
    var i;

    for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
        });
    }
</script>
{% endblock %}

